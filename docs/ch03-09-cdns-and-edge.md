# ネットワークとは

> 参考: https://nextjs.org/learn/foundations/how-nextjs-works/cdns-and-edge

アプリケーションコードがどこに保存され、ネットワークに展開された後に実行されるか知っておくと便利です。
ネットワークは、リソースを共有できるコンピュータ（またはサーバー）が繋がっていると考えることが出来ます。
Next.jsアプリケーションの場合、アプリケーションコードはオリジンサーバー、CSN(Content Delivery Networks)、Edgeに分散させることが出来ます。
それぞれどのようなものか見てみましょう。

## オリジンサーバー

サーバーとは、アプリケーションコードのオリジナルを保存し実行するメインコンピュータのことを言います。

このサーバーを、CDNサーバーやエッジサーバーなど、アプリケーションコードを配布できる他の場所と区別するために、オリジンという用語を使用しています。

オリジンサーバーは、リクエストを受信すると、レスポンスを送信する前に何らかの計算を行います。
計算結果は、CDNやEdgeサーバーに転送することが出来ます。

## Content Delivery Network (CDN)

CDNは、静的コンテンツを世界中の複数の場所に保存し、クライアントとオリジンサーバーの間に設置されます。
新しいリクエストが来ると、ユーザーに最も近いCDNおの拠点がキャッシュされた結果で応答することが出来ます。

![CDN](https://nextjs.org/static/images/learn/foundations/cdn.png)

これにより、リクエストごとに計算を行う必要がなくなり、オリジンの負荷が軽減されます。
またユーザーにとっても、物理的に近い場所から応答が来るので、通信が速くなります。

Next.jsでは、プリレンダリングを前もって行うことができるため、CDNは静的な作業結果を保存するのに適しており、コンテンツ配信をより速くすることが出来ます。

## The Edge

Edgeとは、ユーザーに最も近いネットワークのフリンジ（端）を表す一般的な概念です。
CDNは、ネットワークのフリンジに静的なコンテンツを保存しているため、エッジの一部と考えることが出来ます。

Edgeサーバーは、CDNと同様に世界中の複数の場所に分散して配置されています。
しかし静的なコンテンツを保存するCDNとは異なり、Edgeサーバーの中には小さなコードの断片を実行できるものもあります。

つまり、キャッシュとコード実行の両方を、ユーザーにより近いEdgeで行うことが出来ます。

従来はクライアント、サーバーサイドで行なっていた作業をEdgeに移行することで、
クライアントに送信されるコードの量が減り、ユーザーのリクエストの一部がオリジンサーバーに戻る必要がなくなるため、
アプリケーションのパフォーマンスが向上し、レイテンシーが短縮されます。

Next.jsでは、MiddlewareによってEdgeでコードを実行することができ、さらにReact Server Componentsによって近々実行できるようになります。
